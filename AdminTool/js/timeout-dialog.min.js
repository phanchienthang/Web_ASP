String.prototype.format=function(){for(var n=this,t=arguments.length;t--;)n=n.replace(new RegExp("\\{"+t+"\\}","gm"),arguments[t]);return n};!function(n){n.timeoutDialog=function(t){var i={timeout:1200,countdown:60,title:"Your session is about to expire!",message:"You will be logged out in {0} seconds.",question:"Do you want to stay signed in?",keep_alive_button_text:"Yes, Keep me signed in",sign_out_button_text:"No, Sign me out",keep_alive_url:"/keep-alive",logout_url:null,logout_redirect_url:"/",restart_on_yes:!0,dialog_width:350},r;n.extend(i,t);r={init:function(){this.setupDialogTimer()},setupDialogTimer:function(){var n=this;window.setTimeout(function(){n.setupDialog()},(i.timeout-i.countdown)*1e3)},setupDialog:function(){var t=this;t.destroyDialog();n('<div id="timeout-dialog"><p id="timeout-message">'+i.message.format('<span id="timeout-countdown">'+i.countdown+"<\/span>")+'<\/p><p id="timeout-question">'+i.question+"<\/p><\/div>").appendTo("body").dialog({modal:!0,width:i.dialog_width,minHeight:"auto",zIndex:1e4,closeOnEscape:!1,draggable:!1,resizable:!1,dialogClass:"timeout-dialog",title:i.title,buttons:{"keep-alive-button":{text:i.keep_alive_button_text,id:"timeout-keep-signin-btn",click:function(){t.keepAlive()}},"sign-out-button":{text:i.sign_out_button_text,id:"timeout-sign-out-button",click:function(){t.signOut(!0)}}}});t.startCountdown()},destroyDialog:function(){n("#timeout-dialog").length&&(n("#timeout-dialog").dialog("close"),n("#timeout-dialog").remove())},startCountdown:function(){var r=this,t=i.countdown;this.countdown=window.setInterval(function(){t-=1;n("#timeout-countdown").html(t);t<=0&&(window.clearInterval(r.countdown),r.signOut(!1))},1e3)},keepAlive:function(){var t=this;this.destroyDialog();window.clearInterval(this.countdown);n.get(i.keep_alive_url,function(n){n=="OK"?i.restart_on_yes&&t.setupDialogTimer():t.signOut(!1)})},signOut:function(t){var r=this;this.destroyDialog();i.logout_url!=null?n.post(i.logout_url,function(){r.redirectLogout(t)}):r.redirectLogout(t)},redirectLogout:function(n){var t=i.logout_redirect_url+"?next="+encodeURIComponent(window.location.pathname+window.location.search);n||(t+="&timeout=t");window.location=t}};r.init()}}(window.jQuery);
/*
//# sourceMappingURL=timeout-dialog.min.js.map
*/